<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><base href="/"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><link rel="stylesheet" href="design/index.css"><title>Managing Asynchronous Processing | Hitchy</title></head><body class="page"><div id="wrapper"><div id="north"><div class="navigation"><nav class="primary center-block"><ul><li class="item"><a href="">Home</a></li><li class="item"><a href="about/">About</a></li><li class="item"><a href="download/">Download</a></li><li class="selected item"><a href="concepts/">Concepts</a></li><li class="item"><a href="runtime/">At Runtime</a></li><li class="item"><a href="extensions/">Extensions</a></li></ul><div class="boilerplate"><div class="site-title">Hitchy</div><div class="site-subtitle">a Javascript-based web application framework</div></div></nav></div><div class="center-block"><h1>Managing Asynchronous Processing</h1></div></div><div id="main"><div class="columnizer"><div id="core"><article class="center-block"><h2 id="Befriend-With-Promises"><a href="#Befriend-With-Promises" class="headerlink" title="Befriend With Promises"></a>Befriend With Promises</h2><p>There are many different ways for managing asynchronous processing in your code. And you might encounter some online controversy about using promises or not. We think promises are best concept for handling asynchronous processing while managing fault tolerance. </p>
<p>By relying on recent LTS releases of NodeJS <a href="https://developer.mozilla.org/de/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="external">native support for promises</a> is available. That’s why we didn’t make <a href="http://bluebirdjs.com" target="_blank" rel="external">BluebirdJS</a> a dependency of Hitchy though we consider it to be the best promise library in the field. Instead we try to cope with native API as good as possible and add some selected helpers to Hitchy’s core ourselves.</p>
<h3 id="How-To-Work-With-Native-API"><a href="#How-To-Work-With-Native-API" class="headerlink" title="How To Work With Native API"></a>How To Work With Native API</h3><p>Promises are created using constructor with callback generating what is promised.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>( <span class="function"><span class="keyword">function</span>(<span class="params"> resolve, reject </span>) </span>&#123; ... &#125; )</div></pre></td></tr></table></figure>
<p>Native support for promises includes instance methods <code>Promise#then()</code> and <code>Promise#catch()</code>. In addition class methods <code>Promise.all()</code> and <code>Promise.race()</code> are available to start multiple asynchronous processes in “parallel”.</p>
<blockquote>
<p>Whenever multiple asynchronous processes have to be run consider using <code>Promise.all()</code> instead of chaining promises of either process.</p>
</blockquote>
<h4 id="Spreading-Arguments"><a href="#Spreading-Arguments" class="headerlink" title="Spreading Arguments"></a>Spreading Arguments</h4><p>Promises can deliver single value, only. But this isn’t limited to scalars. So it is common pattern to use arrays to deliver multiple values. Native API doesn’t require <code>Promise#spread()</code> as provided by BluebirdJS. Destructuring function arguments work pretty well instead.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Promise</span>.all( [</div><div class="line">	firstPromise,</div><div class="line">	secondPromise,</div><div class="line">	thirdPromise</div><div class="line">] )</div><div class="line">	.then( <span class="function"><span class="keyword">function</span>(<span class="params"> [ firstResult, secondResult, thirdResult ] </span>) </span>&#123;</div><div class="line">		<span class="comment">// TODO use firstResult etc. here ...</span></div><div class="line">	&#125; );</div></pre></td></tr></table></figure>
<h4 id="Available-Helpers"><a href="#Available-Helpers" class="headerlink" title="Available Helpers"></a>Available Helpers</h4><p>Hitchy provides several helpers in namespace <code>utility.promise</code> of its API.</p>
<table>
<thead>
<tr>
<th>promisified helper</th>
<th>somewhat equivalent to</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>api.utility.promise.each( set, fn )</code></td>
<td><code>set.forEach( fn )</code></td>
</tr>
<tr>
<td><code>api.utility.promise.filter( set, fn )</code></td>
<td><code>set.filter( fn )</code></td>
</tr>
<tr>
<td><code>api.utility.promise.map( set, fn )</code></td>
<td><code>set.map( fn )</code></td>
</tr>
<tr>
<td><code>api.utility.promise.multiMap( set, fn )</code></td>
<td><code>set.map( fn )</code></td>
</tr>
<tr>
<td><code>api.utility.promise.find( set, fn )</code></td>
<td><code>set.find( fn )</code></td>
</tr>
<tr>
<td><code>api.utility.promise.indexOf( set, fn )</code></td>
<td><code>set.indexOf( fn )</code></td>
</tr>
<tr>
<td><code>api.utility.promise.delay( delay, result )</code></td>
<td><code>setTimeout()</code></td>
</tr>
</tbody>
</table>
<p>A callback invoked by any such helper is enabled to return promise for delaying iteration of array. In addition you may iterate array-like data as well.</p>
<h4 id="Promisifying-APIs-of-NodeJS"><a href="#Promisifying-APIs-of-NodeJS" class="headerlink" title="Promisifying APIs of NodeJS"></a>Promisifying APIs of NodeJS</h4><p>Currently, except for some filesystem-related utilities there is no such option included with Hitchy.</p>
<p>Filesystem-related helpers are</p>
<ul>
<li><code>api.utility.file.list( pathname )</code></li>
<li><code>api.utility.file.stat( filename )</code></li>
<li><code>api.utility.file.read( filename, readOptions )</code></li>
<li><code>api.utility.file.readMeta( filename, readOptions )</code></li>
</ul>
<p>As you might expect each of these functions is returning a promise.</p>
</article></div><div id="left"><nav class="sub navigation"><ul><li class="item"><a href="concepts/core.html">Core Principles</a></li><li class="item"><a href="concepts/es6.html">ECMAScript 6</a></li><li class="item"><a href="concepts/dependencies.html">On Dependencies</a></li><li class="item selected"><a href="concepts/promises.html">Promises</a></li><li class="item"><a href="concepts/common_patterns.html">Common Patterns</a></li><li class="item"><a href="concepts/the_meta_file.html">The Meta File</a></li></ul></nav></div><div id="right"></div></div></div><div id="south"><div class="center-block"><div class="copyright">&copy; 2018 <a href="http://cepharum.de" target="_blank">cepharum GmbH</a></div> - <nav class="footer"><ul><li class="item"><a href="imprint/">Imprint</a></li></ul></nav> - <div class="timestamp">Last Update: April 26, 2017 1:16 AM</div></div></div></div><script type="text/javascript" src="js/fx.js"></script></body></html>